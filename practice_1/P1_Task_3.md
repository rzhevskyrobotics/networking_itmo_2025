# Задание 3: Проектирование сети предприятия

## Краткая архитектура

**Топология**: трёхуровневая («Core - Distribution - Access») с кольцевым/ядровым резервированием (leaf-spine/L3 core).

**Кабель/транспорт**: волоконный магистральный каркас (MDF ↔ IDF), MM/SMF, 10/25/40/100G uplinks; горизонтальная сеть - Cat6A до 10 Gbit на порт (→ до 100 м).

**Коммутаторы**: 2 Core L3 (active/standby), 4 Aggregation/Distribution L3, 16 IDF Access PoE-коммутаторов (по 2×48-порта в стеке) - даёт запас портов и отказоустойчивость.

**Брандмауэры/Router**: 2 NGFW в HA, dual-ISP на границе, маршрутизатор с поддержкой BGP/OSPF для выхода.

**Беспроводная сеть**: контроллерная архитектура или облачное управление; AP в зависимости от плотности.

**Сегментация**: VLANs (users, voice, wireless, guest, IoT, servers, mgmt, DMZ). 802.1X + RADIUS (NAC).

**Сервисы**: DHCP (HA), DNS, NTP, Syslog, SIEM/Log server, NMS/ мониторинг, резервное питание (UPS) и стойки (RACK).

## Обоснование архитектуры

**Надёжность**: двух-уровневая агрегация + резервированные uplinks дают отказоустойчивость (если упадёт один IDF-uplink - трафик пойдёт по второму). Core/Firewalls в HA обеспечивают доступ в интернет.

**Масштабируемость**: модель легко масштабируется - можно добавить ещё IDF или увеличил uplink до 25/40/100G.

**Производительность**: L3 агрегация снижает broadcast-домен и упрощает маршрутизацию между VLAN; 10/25G магистраль выдержит пик-нагрузки.

**Безопасность и сегментация**: VLAN + NGFW + 802.1X позволяют контролировать доступ, ограничивать IoT и гостевой трафик.

**Физика (кабель)**: площадь 300×300 м требует распределённых IDF, иначе длина медного кабеля превысит 100 м. Мы рассчитываем оптимальное размещение.

## План размещения коммутаторов / IDF — расчёт

У нас появилась задача: горизонтальный кабель до рабочего места ≤100 м (ограничение Ethernet). Лучший подход — разбить здание на сетку IDF: для 300×300 м удобно взять сетку **4×4 (16 IDF)**.

- Расстояние между соседними IDF центрами = 300 / (4 − 1) = 100 м.

- Максимальное расстояние от точки до ближайшего IDF (полудистанция по диагонали) = √(50² + 50²) ≈ 70.7 м < 100 м.

- Значит любой рабочий стол уложится в 100 м кабеля к ближайшему шкафу — OK.

В центральном месте - **MDF (Main Distribution Frame)**: core switches, internet edge/routers, firewall кластер, серверная инфраструктура, SAN/NAS и т. д.

Каждый IDF содержит: 2×48-портных access-коммутатора (стек/stack) с PoE (для телефонии/AP), patch panels, 1–2 uplink SFP+ (10G) к распределителю.

Почему 2×48-порт? - для резервирования и роста; при отказе или обновлении второй коммутатор принимает нагрузку.

## Пропускная способность и uplinks

Uplinks IDF → Distribution: минимум **2×10G** (LACP) для резервирования и достаточной пропускной способности. При усилении нагрузки - заменить на 2×25G или 2×40G.

Distribution → Core: **25–100G** в зависимости от ожидаемой агрегации трафика (предпочтительно 40/100G для ядра при >1G клиентов).

Wi-Fi: AP с PoE-plus/PoE++; AP подключаются к ближайшему access-коммутатору.

## Устройства

**Core**: 2 модульных L3 коммутатора/спайна с 40/100G портами, поддержкой L3 протоколов (OSPF), VRF, HSRP/VRRP.

**Distribution**: 4 L3 коммутатора с 10/25/40G uplinks.

**Access (IDF)**: 48-порт PoE+ (или PoE++) коммутаторы, стекуемые, с SFP+ uplinks.

**Firewall / Edge Router**: 2 NGFW в HA (stateful, IPS, URL filtering, SSL inspection). Dual-ISP через BGP/VRF если нужно баланс/резерв.

**Wi-Fi**: контроллер + CAP-серия AP (или облачные управляемые AP), поддержка 802.11ax (Wi-Fi 6/6E) для лучшей ёмкости.

**Auth / NAC**: RADIUS сервер (FreeRADIUS/Microsoft NPS), 802.1X для портовой аутентификации.

**Сервера / Storage**: виртуализационный кластер (VMware/Proxmox/Hyper-V), SAN/NAS для критичных данных.

**Мониторинг**: NMS (PRTG/Nagios/Zabbix), SIEM/syslog, NetFlow/sFlow collector.

**UPS и стойки**: UPS для целой серверной, RACK-стойки в MDF и IDF с кондиционированием/охранной сигнализацией.

## Адресная схема и VLAN (примерно для ~1 000 пользователей)

Используем RFC1918, пример - сеть 10.0.0.0/16 и разбивка:

- **VLAN 10 — Users**: 10.1.0.0/22 (≈ 1022 хостов);

- **VLAN 20 — Voice (VoIP)**: 10.2.0.0/22 (segregate & QoS);

- **VLAN 30 — Wireless (corporate)**: 10.3.0.0/22;

- **VLAN 40 — Guest Wi-Fi**: 10.4.0.0/24 (captive portal, интернет только);

- **VLAN 50 — Servers**: 10.5.0.0/24 (MDF);

- **VLAN 60 — DMZ**: 10.6.0.0/24 (прокси, веб-серверы, внешние сервисы);

- **VLAN 100 — Management**: 10.100.0.0/24 (SNMP, NTP, syslog, RADIUS);

- **VLAN 200 — IoT/Printers**: 10.200.0.0/23;

Гейтвеи: на distribution / core (SVI), отказоустойчивость с HSRP/VRRP.

QoS и VoIP присваиваем DSCP для голосового трафика (EF), видеоконференций (AF41) и др. Также Voice VLAN, DHCP опции для телефонов, PoE для IP-телефонов.

## Безопасность

**Сегментация**: гостевой/IoT/серверный и пользовательский трафик в отдельных VLAN.

**802.1X** с RADIUS + MAB для IoT/принтеров.

**DHCP snooping, ARP inspection, IP source guard** в access-уровне.

**NGFW**: всепроходной трафик с политиками, IDS/IPS, SSL inspection по требованию.

**Логи**: централизованный syslog/SIEM, хранение событий минимум 30 дней (или по политике).

**VPN**: SSL/IPSec VPN для удалённого доступа с MFA.

## Подсчёт AP

AP требуются в двух аспектах: покрытия (coverage) + ёмкости (capacity).

Примерные правила:

- Открытый офис (open plan): ≈1 AP на 60–100 m² для покрытия; но для плотной беспроводной нагрузки (много мобильных/конференции) — 1 AP на 30–50 m².

- Для 90 000 m² (300×300) при покрытии 1 AP/100 m² → 900 AP; при 1 AP/50 m² → 1 800 AP.

Поэтому: **точное число AP зависит от**: плотности пользователей, типов приложений (видео/VoIP), помех, высоты потолков и материала стен. Для такого большого здания можно провести **site survey** (планировочный опрос — heatmap), и затем поставить AP с учётом радиопланирования.

Каждый AP подключается к access-switch и требует PoE и uplink-пропускную способность; поэтому при большом числе AP нужно убедиться, что в IDF есть достаточное число портов и PoE budget.

## Администрирование и эксплуатация

**NMS**: мониторинг состояния коммутаторов, вентиляторов, uplinks, AP, интерфейсов.

**Backup config**: периодическое резервное копирование конфигов коммутаторов и firewall.

**Patching windows/linux** для серверов, обновление прошивки сетевого оборудования по графику.

**Документация**: физические схемы/порт-mapping, IP-планы, ACLs.

## Порядок развёртывания

1. Определить точную нагрузку (кол-во сотрудников, AP, камеры, IoT, телефоны).

2. Провести радиоплан и рассчитать количество AP.

3. Разбить здание на IDF (предложенные 16 IDF).

4. Проложить магистральные волоконные трассы и установить MDF.

5. Установить и соединить Core → Distribution → IDF (uplinks), настроить L3, HSRP/VRRP.

6. Настроить VLANs, DHCP HA, RADIUS, 802.1X.

7. Развернуть NGFW/edge и подключить ISP.

8. Пилотная зона: развернуть часть сетки, проверить VoIP, WLAN, мониторинг.

9. Полный rollout по очереди IDF → тестирование → ввод в эксплуатацию.

## Примерный перечень (BOM)

- 2× Core L3 коммутатора (модульные);

- 4× Distribution L3 коммутатора (25/40G uplinks);

- 32× Access 48-port PoE+ (2× на IDF × 16 IDF) - стекуются по паре;

- 2× NGFW (active/standby) + 2× edge routers (dual-ISP);

- AP: количество по результату site survey (оценка: сотни–тысячи для 90k m²);

- 1× RADIUS/AAA сервер, 2× DHCP сервера, 2× DNS сервера (HA), NMS, SIEM, syslog;

- Multimode/Singlemode fiber, SFP+/SFP28 модулы, patch panels, Cat6A кабель, коннекторы;

- UPS, кондиционирование, стойки, PDUs;

Подводя итоги, могу сказать, что такая схема обеспечивает резервирование магистрали и устройств, упрощает управление VLAN/маршрутизацией и позволяет гибко масштабировать сеть по мере роста сотрудников или устройств. Сегментация (VLAN, 802.1X, NGFW) снижает риски безопасности, а PoE и грамотный расчёт uplink-ов покрывают требования VoIP и современных беспроводных сервисов. Финальный шаг — провести site-survey (радиоплан) и уточнить точное число пользователей/камер/AP, после чего можно подготовить детализованный BOM и план развёртывания.
